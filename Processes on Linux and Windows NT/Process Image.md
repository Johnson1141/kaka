# [进程镜像](http://www.tldp.org/LDP/LG/issue23/flower/psimage.html)

可执行文件在磁盘上以特定的格式保存，不同的操作系统定义了不同的格式实现，但是大体上可执行文件有一些共同的存储部分。ELF（可扩展链接格式，Extensible Linked Format）格式是*nix系统上通常使用的格式。ELF程序由ELF头、程序头表（program header table）、一些列段以及一个可选的段头表（section header table）。（程序）头包含内核创建进程镜像所需的全部信息（例如：把程序加载到内存中并分配资源准备运行）。

在多任务操作系统上程序代码必须是可重入的，这样代码才能被多个进程共享。可充入的代码在任何时候都不能修改自己的状态，数据必须和指令段隔离存储，这样每个独立的进程可以维护自己的数据空间。

当一个程序文件加载为进程时，首先进程会被分配为一段虚拟内存作为它的可用地址空间，在进程的地址空间中典型的四个元素为：

* 代码段：存储要运行的程序指令。当程序运行时，处理器不会读取全部的代码段到物理内存中，显然这也是不必要的。取而代之的是动态换页机制，当代码段的一个页面被用到时才加载，加载到内存中的页面可能被进程共享。
* 数据段：分为已初始化变量（externa的全局变量以及static变量）、未初始化变量（*nix系统中的bss段）。数据段通常不在进程之间共享。
* 栈：每个进程通常至少包含两个LIFO栈：内核态使用的内核栈、用户态使用的用户栈。
* 进程控制块：操作系统控制进程所需的信息。
